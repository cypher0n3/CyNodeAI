FROM golang:1.25-alpine AS build

WORKDIR /src
RUN apk add --no-cache ca-certificates git

ENV CGO_ENABLED=0

COPY . .

RUN go build -o /out/worker-api ./worker_node/cmd/worker-api

FROM alpine:3.20
RUN apk add --no-cache ca-certificates

WORKDIR /app
COPY --from=build /out/worker-api /app/worker-api

EXPOSE 8081
ENTRYPOINT ["/app/worker-api"]
